<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MODULE D - Index</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 400px;
        margin: 50px auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      h1 {
        color: #333;
        text-align: center;
        font-size: 24px;
      }
      .links-container {
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      ul {
        list-style-type: none;
        padding: 0;
        margin: 0;
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 10px;
      }
      li {
        margin: 0;
      }
      a {
        display: flex;
        align-items: center;
        justify-content: center;
        aspect-ratio: 1;
        background-color: #6c757d;
        color: white;
        text-decoration: none;
        border-radius: 8px;
        transition: background-color 0.3s;
        font-size: 20px;
        font-weight: bold;
      }
      a.exists {
        background-color: #28a745;
      }
      a.exists:hover {
        background-color: #218838;
      }
      a.not-exists {
        background-color: #6c757d;
        cursor: not-allowed;
        opacity: 0.6;
      }
      a.not-exists:hover {
        background-color: #6c757d;
      }
    </style>
  </head>
  <body>
    <h1>Tasks</h1>
    <div class="links-container">
      <ul>
        <li><a href="d1/" data-folder="d1">D1</a></li>
        <li><a href="d2/" data-folder="d2">D2</a></li>
        <li><a href="d3/" data-folder="d3">D3</a></li>
        <li><a href="d4/" data-folder="d4">D4</a></li>
        <li><a href="d5/" data-folder="d5">D5</a></li>
        <li><a href="d6/" data-folder="d6">D6</a></li>
        <li><a href="d7/" data-folder="d7">D7</a></li>
        <li><a href="d8/" data-folder="d8">D8</a></li>
        <li><a href="d9/" data-folder="d9">D9</a></li>
        <li><a href="d10/" data-folder="d10">D10</a></li>
      </ul>
    </div>

    <script>
      function checkFolders() {
        const links = document.querySelectorAll('a[data-folder]');

        links.forEach((link) => {
          const folderUrl = link.getAttribute('href');

          // Use fetch to check if folder exists
          fetch(folderUrl, {
            method: 'HEAD',
            cache: 'no-cache', // Ensure fresh check on every reload
          })
            .then((response) => {
              if (response.ok || response.status === 403) {
                // Folder exists (200 OK or 403 Forbidden both mean it exists)
                if (!link.classList.contains('exists')) {
                  link.classList.add('exists');
                  link.classList.remove('not-exists');
                  // Remove any click prevention
                  link.onclick = null;
                }
              } else {
                // Folder doesn't exist
                if (!link.classList.contains('not-exists')) {
                  link.classList.add('not-exists');
                  link.classList.remove('exists');
                  link.onclick = function (e) {
                    e.preventDefault();
                    alert('This folder does not exist.');
                  };
                }
              }
            })
            .catch((error) => {
              // Error occurred, assume folder doesn't exist
              if (!link.classList.contains('not-exists')) {
                link.classList.add('not-exists');
                link.classList.remove('exists');
                link.onclick = function (e) {
                  e.preventDefault();
                  alert('This folder does not exist.');
                };
              }
            });
        });
      }

      // Check folders on page load
      document.addEventListener('DOMContentLoaded', function () {
        checkFolders();

        // Auto-refresh every 3 seconds
        setInterval(checkFolders, 3000);
      });
    </script>
  </body>
</html>
